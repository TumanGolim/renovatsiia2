<div class="profile-container">
  <h1>–ü—Ä–æ—Ñ—ñ–ª—å –º–∞–π—Å—Ç—Ä–∞</h1>

  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
    <!-- –û—Å–æ–±–∏—Å—Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è -->
    <div class="form-section">
      <h2>–û—Å–æ–±–∏—Å—Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h2>

      <div formGroupName="personalInfo" class="personal-info-grid">
        <div class="form-group">
          <label for="firstName">–Ü–º'—è*</label>
          <input type="text" id="firstName" formControlName="firstName" />
          <div
            class="error-message"
            *ngIf="
              profileForm.get('personalInfo')?.get('firstName')?.invalid &&
              (profileForm.get('personalInfo')?.get('firstName')?.touched ||
                profileForm.get('personalInfo')?.get('firstName')?.dirty)
            "
          >
            –Ü–º'—è –æ–±–æ–≤'—è–∑–∫–æ–≤–µ –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è
          </div>
        </div>

        <div class="form-group">
          <label for="lastName">–ü—Ä—ñ–∑–≤–∏—â–µ*</label>
          <input type="text" id="lastName" formControlName="lastName" />
          <div
            class="error-message"
            *ngIf="
              profileForm.get('personalInfo')?.get('lastName')?.invalid &&
              (profileForm.get('personalInfo')?.get('lastName')?.touched ||
                profileForm.get('personalInfo')?.get('lastName')?.dirty)
            "
          >
            –ü—Ä—ñ–∑–≤–∏—â–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–µ –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è
          </div>
        </div>

        <div class="form-group">
          <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω*</label>
          <input
            type="tel"
            id="phone"
            formControlName="phone"
            placeholder="+380123456789"
          />
          <div
            class="error-message"
            *ngIf="
              profileForm.get('personalInfo')?.get('phone')?.invalid &&
              (profileForm.get('personalInfo')?.get('phone')?.touched ||
                profileForm.get('personalInfo')?.get('phone')?.dirty)
            "
          >
            –í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É
          </div>
        </div>

        <div class="form-group">
          <label for="experience">–î–æ—Å–≤—ñ–¥ —Ä–æ–±–æ—Ç–∏ (—Ä–æ–∫—ñ–≤)*</label>
          <input
            type="number"
            id="experience"
            formControlName="experience"
            min="0"
          />
          <div
            class="error-message"
            *ngIf="
              profileForm.get('personalInfo')?.get('experience')?.invalid &&
              (profileForm.get('personalInfo')?.get('experience')?.touched ||
                profileForm.get('personalInfo')?.get('experience')?.dirty)
            "
          >
            –í–∫–∞–∂—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π –¥–æ—Å–≤—ñ–¥ —Ä–æ–±–æ—Ç–∏
          </div>
        </div>

        <div class="form-group">
          <label for="email">Email*</label>
          <input
            type="email"
            id="email"
            formControlName="email"
            placeholder="example@email.com"
          />
          <div
            class="error-message"
            *ngIf="
              profileForm.get('personalInfo')?.get('email')?.invalid &&
              (profileForm.get('personalInfo')?.get('email')?.touched ||
                profileForm.get('personalInfo')?.get('email')?.dirty)
            "
          >
            –í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É email –∞–¥—Ä–µ—Å—É
          </div>
        </div>

        <div class="form-group">
          <label for="location">–ú—ñ—Å—Ç–æ</label>
          <input
            type="text"
            id="location"
            formControlName="location"
            placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ –º—ñ—Å—Ç–æ"
          />
        </div>

        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" formControlName="available" />
            –î–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è –∑–∞–º–æ–≤–ª–µ–Ω—å
          </label>
        </div>

        <div class="form-group photo-group">
          <label for="photo">–§–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—è –ø—Ä–æ—Ñ—ñ–ª—é</label>
          <div class="photo-upload">
            <input
              type="file"
              id="photo"
              accept="image/*"
              (change)="onProfilePhotoSelected($event)"
              class="file-input"
            />
            <label for="photo" class="file-label">
              <span class="icon-upload">üì∑</span> –í–∏–±—Ä–∞—Ç–∏ —Ñ–æ—Ç–æ
            </label>
            <div class="preview" *ngIf="selectedPhoto">
              <img [src]="selectedPhoto" alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ—ñ–ª—é" />
            </div>
          </div>
        </div>

        <div class="form-group description-group">
          <label for="description">–ü—Ä–æ —Å–µ–±–µ*</label>
          <textarea
            id="description"
            formControlName="description"
            rows="4"
            placeholder="–†–æ–∑–∫–∞–∂—ñ—Ç—å –ø—Ä–æ —Å–≤—ñ–π –¥–æ—Å–≤—ñ–¥, –∫–≤–∞–ª—ñ—Ñ—ñ–∫–∞—Ü—ñ—é —Ç–∞ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä–æ–±–æ—Ç–∏"
          ></textarea>
          <div
            class="error-message"
            *ngIf="
              profileForm.get('personalInfo')?.get('description')?.invalid &&
              (profileForm.get('personalInfo')?.get('description')?.touched ||
                profileForm.get('personalInfo')?.get('description')?.dirty)
            "
          >
            –û–ø–∏—à—ñ—Ç—å —Å–µ–±–µ (–º—ñ–Ω—ñ–º—É–º 50 —Å–∏–º–≤–æ–ª—ñ–≤)
          </div>
        </div>
      </div>
    </div>

    <!-- –ü–æ—Å–ª—É–≥–∏ —Ç–∞ –Ω–∞–≤–∏—á–∫–∏ -->
    <div class="form-section">
      <h2>–ú–æ—ó –ø–æ—Å–ª—É–≥–∏ —Ç–∞ –Ω–∞–≤–∏—á–∫–∏</h2>

      <div class="skills-selection">
        <div class="category-selector">
          <h3>–í–∏–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ä–æ–±—ñ—Ç</h3>
          <div class="categories-grid">
            <button
              type="button"
              *ngFor="let category of categories"
              class="category-btn"
              [class.active]="selectedCategory === category.category_name"
              (click)="selectCategory(category.category_name)"
            >
              {{ category.category_name }}
            </button>
          </div>

          <div class="subtypes-container" *ngIf="selectedCategory">
            <h4>{{ selectedCategory }}</h4>
            <div class="subtypes-grid">
              <div
                *ngFor="let category of categories"
                class="subtype-items"
                [class.visible]="selectedCategory === category.category_name"
              >
                <button
                  type="button"
                  *ngFor="let subtype of category.subcategories"
                  class="subtype-btn"
                  (click)="addSkill(category, subtype)"
                >
                  {{ subtype.subcategory_name }}
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="selected-skills">
          <h3>–í–∏–±—Ä–∞–Ω—ñ –Ω–∞–≤–∏—á–∫–∏ —Ç–∞ —Ü—ñ–Ω–∏</h3>
          <div class="skills-list" formArrayName="skills">
            <div *ngIf="skillsArray.length === 0" class="no-skills">
              –í–∏ —â–µ –Ω–µ –≤–∏–±—Ä–∞–ª–∏ –∂–æ–¥–Ω–æ—ó –Ω–∞–≤–∏—á–∫–∏
            </div>

            <div
              *ngFor="let skill of skillsArray.controls; let i = index"
              [formGroupName]="i"
              class="skill-item"
            >
              <div class="skill-info">
                <span class="skill-category">{{
                  skill.get("category_name")?.value
                }}</span>
                <span class="skill-subtype">{{
                  skill.get("subcategory_name")?.value
                }}</span>
              </div>

              <div class="skill-price">
                <label>–¶—ñ–Ω–∞ –≤—ñ–¥ (‚Ç¥):</label>
                <input type="number" formControlName="price_from" min="0" />
                <label>–¥–æ (‚Ç¥):</label>
                <input type="number" formControlName="price_to" min="0" />
              </div>

              <button
                type="button"
                class="remove-skill"
                (click)="removeSkill(i)"
                title="–í–∏–¥–∞–ª–∏—Ç–∏ –Ω–∞–≤–∏—á–∫—É"
              >
                ‚úï
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –§–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó —Ä–æ–±—ñ—Ç -->
    <div class="form-section">
      <h2>–ú–æ—ó —Ä–æ–±–æ—Ç–∏</h2>
      <div class="work-photos-section">
        <div class="work-photos-upload">
          <input
            type="file"
            id="workPhotos"
            accept="image/*"
            multiple
            (change)="onWorkPhotoSelected($event)"
            class="file-input"
          />
          <label for="workPhotos" class="file-label">
            <span class="icon-plus">+</span> –î–æ–¥–∞—Ç–∏ —Ñ–æ—Ç–æ —Ä–æ–±—ñ—Ç
          </label>
        </div>

        <div class="work-photos-gallery" *ngIf="workPhotos.length > 0">
          <div class="work-photo-item" *ngFor="let photo of workPhotos">
            <div class="photo-container">
              <img [src]="photo.src" alt="–§–æ—Ç–æ —Ä–æ–±–æ—Ç–∏" />
              <button
                type="button"
                class="remove-photo"
                (click)="removeWorkPhoto(photo.id)"
                title="–í–∏–¥–∞–ª–∏—Ç–∏ —Ñ–æ—Ç–æ"
              >
                ‚úï
              </button>
            </div>
          </div>
        </div>

        <div class="no-photos-message" *ngIf="workPhotos.length === 0">
          –£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ–π –≤–∏–∫–æ–Ω–∞–Ω–∏—Ö —Ä–æ–±—ñ—Ç. –î–æ–¥–∞–π—Ç–µ —Ñ–æ—Ç–æ, —â–æ–± –ø—ñ–¥–≤–∏—â–∏—Ç–∏
          –¥–æ–≤—ñ—Ä—É –∫–ª—ñ—î–Ω—Ç—ñ–≤.
        </div>
      </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π -->
    <div class="form-actions">
      <button type="submit" class="save-btn">–ó–±–µ—Ä–µ–≥—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å</button>
      <button type="button" class="cancel-btn">–°–∫–∞—Å—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–∏</button>
    </div>
  </form>
</div>
